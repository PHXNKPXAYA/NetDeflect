
; Please read all comments carefully before modifying values.
; This file controls application behavior, including detection thresholds, notifications, and firewall mitigation.
; Do not remove section headers (e.g., [capture], [triggers]) or field names.

# Your servers displayed IP address method.
[ip_detection]
# Options: google_dns, opendns, ipify, icanhazip, local
ip_method = opendns

########################################
# NETWORK PACKET CAPTURE CONFIGURATION
########################################

[capture]
# The name of your network interface.
# Use `ip a` or `ifconfig` to identify your active interface (e.g., eth0, wlan0, enp3s0).
network_interface=enp0s3

# Additional filter arguments for tcpdump (advanced).
# Leave empty for full traffic capture.
# Example for SYN/ACK packets only: tcp[tcpflags] & (tcp-syn|tcp-ack) != 0
filter_arguments=

########################################
# NOTIFICATION SETTINGS
########################################

[notification]
# Discord Webhook URL used to send alerts during an attack.
# You can generate one by editing a Discord channel → Integrations → Webhooks.
webhook_url=https://discord.com/api/webhooks/1466239445429784619/zznft_HaFgFFRjhKcMe0jYJaSwxiXsP-rWLDYyxkO6jPsU4lYvxKyCshVBXPxlXiYVJj

########################################
# ATTACK DETECTION & MITIGATION SETTINGS
########################################

[triggers]
# What condition should trigger mitigation?
# Options:
#   P  - Packets Per Second threshold
#   M  - Megabytes Per Second threshold
#   MP - Both PPS and MBPS must be exceeded (recommended)
#   MEGABYTES IS NOT THE SAME AS MEGABITS, 1 BYTE = 8 BITS!
trigger_mode=P

# The minimum number of packets per second to consider an attack.
# Lower this value to make detection more sensitive.
pps_threshold=2500

# The minimum network speed in megabytes per second to consider an attack.
# Set to 0 to disable MBPS threshold.
# 240 Mbit / 8 = 30 MByte/s
mbps_threshold=10

# Number of seconds to pause between automatic mitigations.
# Helps reduce repeated action during ongoing attacks.
mitigation_pause=40

# Number of packets to capture during an attack for analysis.
# Lower this if you experience memory or performance issues.
# Modify this based on your port speed and how much data you expect.
packet_count=50000

# Number of attack-type occurrences required to confirm an attack.
# If packet_count is modified, this will also need to be modified.
# Acts as a sensitivity filter — higher value = stricter classification.
detection_threshold=5000

########################################
# FIREWALL / BLOCKING SYSTEM CONFIGURATION
########################################

[firewall]
# Select the blocking method for malicious IPs.
# Options:
#   iptables   - Traditional firewall (Linux)
#   ufw        - Ubuntu Firewall wrapper
#   ipset      - Efficient IP list blocking
#   blackhole  - Adds a null route to silently drop traffic (recommended)
firewall_system=blackhole

########################################
# ADVANCED MITIGATION SETTINGS
########################################

[advanced_mitigation]
# Enable fallback blocking when no specific attack signatures are detected
# Set to False to only block when a specific attack signature is identified
enable_fallback_blocking=False

# Block top traffic contributors when dealing with 'other_attacks' category
# WARNING: This may lead to false positives, use with caution
block_other_attack_contributors=True

# Enable automatic pattern detection for unclassified attacks
# This feature will identify common patterns and save them for review
enable_pattern_detection=True

# Block IPs associated with auto-detected patterns
# Set to False if you only want to log patterns without blocking
block_autodetected_patterns=True

# Minimum contribution percentage to consider an IP as malicious (1-100)
# Higher values reduce false positives but may miss some attackers
contributor_threshold=1

# Maximum number of PCAP files to keep (0 = keep all files)
# Older files will be deleted when this limit is reached
max_pcap_files=10


########################################
# IP WHITELISTING
########################################

[whitelist]
# List of IPs that should NEVER be blocked, such as your home IP or critical infrastructure.
# As it is in beta, please ensure to add your IP address to avoid being blocked.
# Use a comma and space between entries. Example: 1.1.1.1, 8.8.8.8, 139.99.201.1
trusted_ips=104.28.195.105

########################################
# EXTERNAL FIREWALL API INTEGRATION
########################################

[external_firewall]
# Enable external firewall API integration to send IPs to third-party services
enable_api_integration=False

# API endpoint URL
# Use a full URL including https:// and any required path
api_endpoint=https://api.example.com/firewall/block

# API authentication method (basic, bearer, header, none)
auth_method=bearer

# API authentication credentials
auth_token=your_api_token_here
auth_username=
auth_password=

# Additional headers (in JSON format)
# Example: {"X-Custom-Header": "value", "Content-Type": "application/json"}
additional_headers={"Content-Type": "application/json"}

# Request method (GET, POST, PUT, PATCH, DELETE)
request_method=POST

# Sending mode: single (one IP per request), batch (groups of IPs), or all (all IPs in one request) [I wouldn't recommend single as it may get you rate limited]
sending_mode=all

# Maximum IPs per batch (for batch mode)
max_ips_per_batch=100

# Request body template (JSON)
# Available placeholders:
# {{IP}} - Single IP (for single mode)
# {{IP_LIST}} - Array of IPs as strings ["1.1.1.1", "2.2.2.2"] (for batch/all modes)
# {{IP_CSV}} - Comma-separated IPs "1.1.1.1,2.2.2.2" (for batch/all modes)
# {{TIMESTAMP}} - Current timestamp
# {{SOURCE}} - "NetDeflect"
# Note: Escape quotes with backslash
request_body_template={"source": "NetDeflect", "timestamp": "{{TIMESTAMP}}", "ips": {{IP_LIST}}}

# Request timeout in seconds
request_timeout=10



